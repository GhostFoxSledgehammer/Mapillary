findbugs {
  toolVersion = project.property('tool.findbugs.version')
  ignoreFailures = true
  effort = "max"
  reportLevel = "low"
  sourceSets = [sourceSets.main, sourceSets.test]
}
tasks.withType(FindBugs) {
  reports {
    xml.enabled = false
    html.enabled = true
  }
}

jacoco {
  toolVersion = project.property('tool.jacoco.version')
}
jacocoTestReport {
  reports {
    xml.enabled true
    html.destination "$buildDir/reports/jacoco"
  }
}
build.dependsOn jacocoTestReport

pmd {
  toolVersion project.property('tool.pmd.version')
  ignoreFailures true
  targetJdk 1.7 // 1.8 is not yet available (as of Gradle 3.0, see https://docs.gradle.org/current/javadoc/org/gradle/api/plugins/quality/TargetJdk.html)
  ruleSetConfig = resources.text.fromFile('config/pmd/ruleset.xml')
  sourceSets = [sourceSets.main, sourceSets.test]
}

sonarqube {
  properties {
    property 'sonar.forceAuthentication', 'true'
    property 'sonar.host.url', 'https://sonarqube.com'
    property 'sonar.projectKey', 'org.openstreetmap.josm.plugins:Mapillary'
    property 'sonar.projectName', 'josm-mapillary-plugin'
    property 'sonar.projectVersion', getVersionName()
    property 'sonar.projectDescription', property('plugin.description')
    property 'sonar.sources', ['src']
  }
}
