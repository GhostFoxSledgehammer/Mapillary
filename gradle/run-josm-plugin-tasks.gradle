apply from: buildscript.sourceFile.parentFile.path + '/run-josm-config.gradle'
apply from: buildscript.sourceFile.parentFile.path + '/run-josm-tasks.gradle'

task updateCurrentPlugin(type: Copy) {
  description 'Puts the plugin-JAR generated by the `jar`-task into `build/.josm/`'
  dependsOn jar
  dependsOn initJosmPrefs
  from configurations.requiredPlugin
  from "$buildDir/libs/${project.name}.jar"
  into "$tmpJosmHome/plugins"
  rename('(.*)-\\.jar', '$1.jar')
  rename(project.name, project.hasProperty('plugin.jar.name') ? project.property('plugin.jar.name') : project.name)
}
updateJosmPlugins.dependsOn updateCurrentPlugin
