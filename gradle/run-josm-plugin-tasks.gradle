apply from: buildscript.sourceFile.parentFile.path + '/run-josm-config.gradle'
apply from: buildscript.sourceFile.parentFile.path + '/run-josm-tasks.gradle'

task updatePluginDependencies(type: Copy) {
  from configurations.requiredPlugin
  into "$tmpJosmHome/plugins"
  rename('(.*)-\\.jar', '$1.jar')
}

task updateCurrentPlugin(type: Copy) {
  description 'Puts the plugin-JAR generated by the `jar`-task into `build/.josm/`'
  dependsOn jar
  dependsOn initJosmPrefs
  dependsOn updatePluginDependencies
  from jar.outputs
  into "$tmpJosmHome/plugins"
  rename('.*', project.hasProperty('plugin.jar.name') ? project.property('plugin.jar.name') : '$1')
}
updateJosmPlugins.dependsOn updateCurrentPlugin
